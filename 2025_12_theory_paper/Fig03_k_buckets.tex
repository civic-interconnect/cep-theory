\begin{figure}[!htbp]
  \centering
  \begin{tikzpicture}[
      >=Latex,
      bucket/.style={
          rectangle,
          draw,
          rounded corners,
          minimum width=2.5cm,
          minimum height=1.0cm,
          align=center
        }
    ]

    \node at (0, 0) {\small Feature combination groups (account age, client, temporal bin, etc.)};
    \node (klabel) at (0, -0.6) {\small k = 5};
    \draw[dashed] (-3.0, -1.0) -- (3.0, -1.0);

    \node[bucket] at (0, -2.0) (b1) {Bucket A\\(size = 12)};
    \node[bucket, below=0.9cm of b1] (b2) {Bucket B\\(size = 6)};
    \node[bucket, below=0.9cm of b2, fill=gray!10] (b3) {Bucket C\\(size = 3)};
    \node[bucket, below=0.9cm of b3, fill=gray!10] (b4) {Bucket D\\(size = 2)};

    % Annotations
    \node[right=2.3cm of b1, align=left] (shown) {Released in P3Tag aggregates:\\
      \small Bucket A (size 12)\\
      \small Bucket B (size 6)};
    \node[right=2.3cm of b3, align=left] (hidden) {Suppressed or merged:\\
      \small Bucket C (size 3)\\
      \small Bucket D (size 2)};

    \draw[->] (b1.east) -- (shown.west);
    \draw[->] (b2.east) -- (shown.west);
    \draw[->] (b3.east) -- (hidden.west);
    \draw[->] (b4.east) -- (hidden.west);

  \end{tikzpicture}
  \caption{K-anonymity enforcement showing the suppression mechanism for rare behavioral patterns. Feature combination groups exceeding the threshold ($k \ge 5$ shown here, $k \ge 100$ in production) are released in aggregates, while smaller groups are suppressed or merged to prevent re-identification.}

  \label{fig:P3Tag-kanon-buckets}
\end{figure}
